**Интервью с директором**

| № | Вопрос                          | Ответ                                                                                                                                                                                                                                                    |
| - | ------------------------------- | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| 1 | Что необходимо сделать?         | Необходимо оптимизировать трудозатраты для увеличения прибыли с помощью новой системы и роботов                                                                                                                                                          |
| 2 | Какие есть критерии успешности? | Минимальный: Скорость обслуживания не должна уменьшиться<br>Максимальный: Скорость обслуживания должна вырасти на 30%<br>Минимальный: Операционные затраты не должны вырасти как минимум<br>Максимальный: Операционные затраты должны сократиться на 30% |

**Требования**

| № | Тип требования    | Требование                                         |
| - | ----------------- | -------------------------------------------------- |
| 1 | Бизнес требование | Оптимизировать трудозатраты для увеличения прибыли |
| 2 | Бизнес требование | Скорость обслуживания не должна уменьшиться        |
| 3 | Бизнес требование | Скорость обслуживания должна вырасти на 30%        |
| 4 | Бизнес требование | Операционные затраты не должны вырасти             |
| 5 | Бизнес требование | Операционные затраты должны сократиться на 30%     |


**Интервью с технологом**

| № | Вопрос                                                                                           | Ответ                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| - | ------------------------------------------------------------------------------------------------ | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| 1 | Какую роль выполняет?                                                                            | Контроль процессов:<br>производственных,<br>обслуживания,<br>складирования,<br>сбыта,<br>закупки                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| 2 | Какие системы используются на данный момент?                                                     | Системы кассовых аппаратов;<br>Система закупки и расхода инвентаризация и тд учетконтроль результаты;<br>Система кадрового учета;<br>Система на производстве;<br>Система фиксации заказов с кассы.<br>                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| 3 | Основные роли бизнес-процесса as-is                                                              | В зале сотрудники формируют заказы и выдают их клиентам<br>На кухне работают заправщики, фритюрщики, грильщики и кооринациторы<br>Технические сотрудники пополняет продукцию на складе, делают закупки<br>Менеджеры решают организационые вопросы по обслуживанию и производству<br>                                                                                                                                                                                                                                                                                                                                                                                  |
| 4 | Основные бизнес-процессы as-is                                                                   | Операционное обслуживание<br><br>Есть склад, на котором хранятся продукты<br>За каждую смену есть расходы<br>Клиенты делают заказы, кассиры принимают заказы, со склада поступают продукты на кухню<br>В конце каждой смены производится инветаризация<br>Есть проблема в частых недостачах либо излишках<br>Функции с закупками происходят за рамками смены каждые 2-3 дня<br>Процессы связанные с хранением (заморозка, поддержка температура, отслеживание сроков хранения)<br>Есть карта приготовления блюд в виде инструкций (чек лист приготовления, регламент)<br>Роботы должны автоматизировать часть функций<br>Есть регламент как пользоватья оборудованием |
| 5 | Какая часть процессов должна быть автоматизирована?<br>                                          | Необходимо автоматизировать конвейерную линию<br>Планируется частичная замена людей роботами на точках с оборудованием (тостер, гриль, заправка)<br>Замена кассиров, клиентам должна быть доступна возможность оплаты через терминал или приложение<br>                                                                                                                                                                                                                                                                                                                                                                                                               |
| 6 | Какие появятся роли после внедрения системы?<br>Какие требования к новой системе для этих ролей? | Останутся люди, которые будут следить за роботами (сотрудники поддержки), остатками и процессом в целом<br>Администратору ресторана необходима возможность редактирования меню блюд<br>Потребуется интерфейс для сотрудника бекофиса для складских процессов<br>Нужно организовать АРМ для менеджера<br>Для клиентов нужно создать приложение для оформления заказов и оплаты + необходим терминал в зале<br>Есть возможность интеграции с системой заказа продуктов<br>                                                                                                                                                                                              |
| 7 | Какая бизнес-модель обслуживания?                                                                | Есть возможность оформить заказ на вынос в зале либо забрать с собой<br>Доставки в данный момент нет и не предполагается                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |

**Требования**

| №  | Тип требования               | Требование                                                                                      |
| -- | ---------------------------- | ----------------------------------------------------------------------------------------------- |
| 1  | Функциональное требование    | Программная поддержка для работы с роботами на точках с оборудованием (тостер, гриль, заправка) |
| 2  | Пользовательское требование  | Интерфейс для мониторинга и управления роботами                                                 |
| 3  | Не функциональное требование | Интеграция с платежной системой для осуществления оплаты через терминал                         |
| 4  | Пользовательское требование  | Интерфейс для оформление заказов и оплаты в мобильном приложении клиентов                       |
| 5  | Функциональное требование    | Возможность мониторинга и управления роботами                                                   |
| 6  | Функциональное требование    | Возможность мониторинга остатков                                                                |
| 7  | Пользовательское требование  | Интерфейс для редактирования меню блюд для администратора ресторана                             |
| 8  | Пользовательское требование  | Интерфейс для управления складскими процессами сотрудникам бекофиса                             |
| 9  | Системное требование         | АРМ (автоматизированное рабочее место) менеджера для управления рестораном                      |
| 10 | Не функциональное требование | Интеграция с системой заказа продуктов                                                          |

**Интервью с продактом**

| № | Вопрос                                                                      | Ответ                                                                                                                                                                                                                                                                                                                                            |
| - | --------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ |
| 1 | На какие метрики должна повлиять система?<br>Что входит в MVP продукт?      | 1 ресторан<br>5000 заказов в день                                                                                                                                                                                                                                                                                                                |
| 2 | Какие планы на будущее,<br>планируется ли масштабирование?                  | В планах интреграция с сервисами доставки для отправки заказов клиентам<br>После успешного внедрения системы для одного ресторана, планируется<br>масштабирование до 100 ресторанов и 5000 заказов для каждого ресторана<br>Бюджет на привлечения не тратим, со стороны команды маркетинга все разработано,<br>решаем только технические моменты |
| 3 | Какой бюджет и сроки?                                                       | Бюджет 100 млн руб<br>Срок 1 год для MVP продукта<br>Далее по этой модели необходимо внедрить систему в 100 ресторанов                                                                                                                                                                                                                           |
| 4 | Какая доступность ресторана?                                                | Ресторан работает 24/7                                                                                                                                                                                                                                                                                                                           |
| 5 | Какие этапы автоматизации процессов по приоритетам?                         | В MVP система должна автоматизирровать только процесс приготовления блюд с помощью роботов<br>Автоматизация процессов хранения, выдачи и доставки это следующий этап                                                                                                                                                                             |
| 6 | Есть ли конкуренты?                                                         | В рамках процессов автоматизации - нет                                                                                                                                                                                                                                                                                                           |
| 7 | Что входит в бюджет 100 млн руб?                                            | Разработка системы и интеграция с другими системами (приложение для оффлайн терминала<br>мобильное и web приложение)<br>Роботы в бюджет не входят                                                                                                                                                                                                |
| 8 | Какой сегмент на рынке обслуживает ресторан?<br>Какое главное преимущество? | Основная аудитория - любители фастфуда<br>Преимущество - быстро готовить                                                                                                                                                                                                                                                                         |


**Требования**

| №  | Тип требования               | Требование                                                                                |
| -- | ---------------------------- | ----------------------------------------------------------------------------------------- |
| 1  | Бизнес-требование            | Оптимизировать время выдачи заказов клиентам                                              |
| 2  | Бизнес-требование            | Оптимизировать время приготовления блюд                                                   |
| 3  | Не функциональное требование | Система должна поддерживать работу 24/7                                                   |
| 4  | Не функциональное требование | Система должна быть способной обрабатывать 5000 заказов в день                            |
| 5  | Бизнес-требование            | Система должна быть готова к выпуску в течение 1 года (MVP продукта).                     |
| 6  | Не функциональное требование | Система должна обеспечивать интеграцию с сервисами доставки для отправки заказов клиентам |
| 7  | Не функциональное требование | Система должна поддерживать масштабирование до 100 ресторанов                             |
| 8  | Системное требование         | Необхоимо разработать web приложение для оформления заказов                               |
| 9  | Системное требование         | Необхоимо разработать мобильное приложение для оформления заказов                         |
| 10 | Системное требование         | Необхоимо разработать приложение для оффлайн терминала для оформления заказов             |

**Интервью с техническим директором**

| №  | Вопрос                                                                              | Ответ                                                                                                                                                                                                                                                                                                                                                                                    |
| -- | ----------------------------------------------------------------------------------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| 1  | Что с инфраструктурой на данный момент, возможна ли интеграция?                     | Текущая инфраструктура устарела, интегрироваться с ней не нужно,<br>планируется использовать облачные сервисы                                                                                                                                                                                                                                                                            |
| 2  | Кто основные пользователи системы?                                                  | Сотрудники бизнес-отдела, смотрят отчеты<br>Клиенты, которые делают заказ<br>Технолог, который контролирует процессы в основном зале ресторана<br>и обслуживает роботов<br>Сотрудник по технологическим картам блюд<br>Сотрудники первой линии поддержки                                                                                                                                 |
| 3  | Какие операционные системы должна поддерживать система<br>и приложение?             | PC - Windows<br>Мобильное приложение - IOS/Android (кроссплатформа и нативно)                                                                                                                                                                                                                                                                                                            |
| 4  | Какие компоненты должна включать система по хранению продуктов?                     | Система по хранению продуктов должна быть написана с 0,<br>никаких интеграций с текущеми системами не требуется<br>Нужна база данных, в которой будет храниться информация о продуктах:<br>Наименование, дата поступления, сроки хранения                                                                                                                                                |
| 5  | Опишите бизнес-процессы роботов                                                     | Для каждой категории предусмотрено по 2 робота:<br>заправщики, фритюрщики, грильщики и роботы для напитков<br><br>Робот берет заказ и готовит, если поступает новый заказ, его берет другой робот,<br>если поступает 3 заказ на ту же категорию блюда, то создается очередь<br>Один робот не может делать 2 заказа одновременно<br>Контролем и обслуживанием роботов занимается технолог |
| 6  | Как реагировать на потери связи с облачными технологиями?                           | Если связь потеряна, технолог должен получить уведомление и заняться инцидентом<br>Системы оповещений о сбоях - Apex<br>Необходим стандартный мониторинг системы, например Grafana                                                                                                                                                                                                       |
| 7  | Какую нагрузку должна выдерживать система?                                          | Система должна выдерживать 5000 заказов в день и одновременно 100 сессий<br>При масштабировании до 10000 сессий одновременно                                                                                                                                                                                                                                                             |
| 8  | Какую статистику должна собирать система?                                           | Система должна формировать отчет по кол-ву заказов                                                                                                                                                                                                                                                                                                                                       |
| 9  | Как сотрудник по технологическим картам блюд<br>будет взаимодействовать с системой? | Сотруднику по технологическим картам блюд должен быть доступен интерфейс для редактирования и<br>формирования этих карт                                                                                                                                                                                                                                                                  |
| 10 | Какие требования к отказоустойчивости системы?                                      | Downtime системы не больше 10 минут                                                                                                                                                                                                                                                                                                                                                      |
| 11 | Какая локализация у системы?                                                        | Русский язык                                                                                                                                                                                                                                                                                                                                                                             |
| 12 | Какие интеграции должна поддерживать система для оплаты заказов?                    | Для мобильного приложения - СБП<br>Для терминала - обычная оффлайн касса приема кредитных карт                                                                                                                                                                                                                                                                                           |


**Требования**

| №  | Тип требования               | Требование                                                                                                                             |
| -- | ---------------------------- | -------------------------------------------------------------------------------------------------------------------------------------- |
| 1  | Не функциональное требование | Система должна использовать облачные сервисы, не требующие интеграции с текущей инфраструктурой                                        |
| 2  | Пользовательское требование  | Сотрудники бизнес-отдела должны иметь доступ к отчетам.                                                                                |
| 3  | Пользовательское требование  | Клиенты должны иметь возможность делать заказы через приложение                                                                        |
| 4  | Пользовательское требование  | Сотрудник по технологическим картам блюд должен иметь доступ к интерфейсу для работы с картами.                                        |
| 5  | Пользовательское требование  | Сотрудники первой линии поддержки должны иметь доступ к системе для решения инцидентов системы                                         |
| 6  | Не функциональное требование | Система должна поддерживать PC с операционной системой Windows                                                                         |
| 7  | Не функциональное требование | Мобильное приложение должно быть доступно на IOS и Android                                                                             |
| 8  | Не функциональное требование | Система по хранению продуктов должна быть написана с нуля                                                                              |
| 9  | Не функциональное требование | Необходима база данных для хранения информации о продуктах                                                                             |
| 10 | Не функциональное требование | Downtime системы не должен превышать 10 минут                                                                                          |
| 11 | Пользовательское требование  | Технолог должен получать уведомления о сбоях                                                                                           |
| 12 | Не функциональное требование | Система должна иметь систему оповещений о сбоях, например, Apex                                                                        |
| 13 | Не функциональное требование | Необходим стандартный мониторинг системы, например, Grafana.                                                                           |
| 14 | Не функциональное требование | Система должна выдерживать 5000 заказов в день и одновременно 100 сессий.<br>При масштабировании до 10000 сессий одновременно.         |
| 15 | Функциональное требование    | Система должна формировать отчет по количеству заказов.                                                                                |
| 16 | Не функциональное требование | Система должна быть доступна на русском языке                                                                                          |
| 17 | Не функциональное требование | Для мобильного приложения должна быть поддержка СБП<br>Для терминала должна быть поддержка обычной оффлайн кассы приема кредитных карт |

**Карта пользовательских историй** 

![Image alt](https://github.com/dmatwe/projects/blob/main/OTUS_SA_ADVANCED/User%20Story/Карта%20пользовательских%20историй%20.png)

**US клиент** 

![Image alt](https://github.com/dmatwe/projects/blob/main/OTUS_SA_ADVANCED/User%20Story/US%20клиент.png)

**US Сотрудник производства** 

![Image alt](https://github.com/dmatwe/projects/blob/main/OTUS_SA_ADVANCED/User%20Story/US%20Сотрудник%20производства.png)


**US Менеджер зала** 

![Image alt](https://github.com/dmatwe/projects/blob/main/OTUS_SA_ADVANCED/User%20Story/US%20Менеджер%20зала.png)

**US Менеджер ассортимента** 

![Image alt](https://github.com/dmatwe/projects/blob/main/OTUS_SA_ADVANCED/User%20Story/US%20Менеджер%20ассортимента.png)


**Defenition of Done** 

- Соответствует определенным ожиданиям стейкхолдеров
- Успешно завершено тестирование в соответствии с критериями приемки
- Владелец продукта (Product Owner) принял задачу
- Регрессионные тесты проходят
- Выполнены нефункциональные требования
- Обновлена пользовательская документация

**Первый релиз** 
- MVP US клиент

- [Miro (полная версия)](https://miro.com/welcomeonboard/TW0xZXBtOEEwaVpBNWJIcnZEcW1qYkJuNWN1RFJwcG0xd2FzZzVBa2VDTDU3bmhNdzRRN2FnZDRiU2FvTkRLSnwzNDU4NzY0NTIzNjk5NzU4NDczfDI=?share_link_id=699446562339)


**BPMN бизнес-процесса оформление заказа**

![Image alt](https://github.com/dmatwe/projects/blob/main/OTUS_SA_ADVANCED/BPMN/Робот%20и%20точка%20оформление%20заказа.png)

**BPMN бизнес-процесса регистрация клиента**

![Image alt](https://github.com/dmatwe/projects/blob/main/OTUS_SA_ADVANCED/BPMN/Робот%20и%20точка%20регистрация%20клиента.png)

**Описание кейса**

**Как вы видите процесс заказа блюда в вашем ресторане?**
Человек приходит к нам в ресторан и обращается к информационному меню. На
стойке он может выбрать категорию блюд (бургеры, напитки, прочее), затем конкретное
блюдо, добавить его в корзину. Когда клиент выбрал все что ему нужно и готов
оплатить заказ, то ему нужно показать полный список заказанного.
При этом, если у клиента есть бургер, то нужно дополнительно предложить к заказу
картошку и пирожок.
При сумме заказа более 1500 рублей или наличии специального комбо, мы даем в
подарок фирменный стакан “робот и точка”. При этом, если заказ происходит в будние
дни с 10 до 16, то сделать скидку, т.к. это будет считаться бизнес-ланчем.
Клиент указывает где он будет есть, с собой или в зале.
Перед оплатой, важно спросить является ли клиент участником нашей системы
лояльности. Если нет, то предложить зарегистрироваться. Если да, то предложить
начислить или списать баллы.
После этого, подсчитать итоговую сумму с учетом бонусов, если они были
использованы и перейти к процессу оплаты.


**Что будет, если в процессе оформления заказа клиент уйдет?**
Вообще, в любой момент должна быть возможность прекратить оформление заказа,
т.к. человек может уйти по разным причинам. Тогда новый клиент, следующий по
очереди сможет начать оформление заказа
Если клиент не делает никаких действий дольше 2 минут, то показать окошко
предупреждение “вы еще с нами?”. Если в течение еще двух минут оно не будет
закрыто или начат новый заказ, то надо вернуть стойку на главное меню
Что делать, если в процессе оформления заказа, кончится какой-то ингридиент?
Ох, такое довольно редко случается. Желательно не показывать клиенту блюда,
которые мы не можем в данный момент приготовить.


**А что если все же случилось?**
Сослаться на технические шоколадки и предложить замену из аналогичных позиций
меню.
Что произойдет после успешного заказа?
На табло в ресторане отобразится номер заказа клиента и информация о том, что
заказ готовится. Когда заказ будет готов, он подсветится на табло и его можно будет
забрать.


**Как происходит регистрация в системе лояльности?**
Пользователь вводит номер телефона, мы проверяем есть ли он в системе. Если такой
номер уже зарегистрирован, то система предлагает восстановить пароль или ввести
другой номер. Если номер уникальный, то нужно запросить у клиента: дату рождения
(чтоб давать скидки в день рождения), имя, фото и емейл по желанию.



**Модель предметной области**
**диаграмме-классов**

![Image alt](https://github.com/dmatwe/projects/blob/main/OTUS_SA_ADVANCED/UML/uml_er.png)

```json
@startuml
!theme plain
skinparam linetype ortho


Entity  Клиент {
  ФИО
  Номер Тел
  Кол-во баллов
  Добавить товар в корзину()
}


Entity  Заказ {
  Номер заказа
  Время заказа
  Время получения заказа
  Способ получения заказа 
  Статус заказа
  Изменить статус заказа()

}

Entity  Детали_оплаты_заказа {
  Номер заказа
  Сумма заказа
  Кол-во списанных баллов
  Кол-во начисленных баллов
  Время оплаты заказа
  Способ оплаты заказа
  Статус оплаты заказа
  Изменить способ оплаты заказа()
  Изменить кол-во баллов для списания()
  Изменить статус оплаты заказа()

}

Entity  Товар {
  Наименование
  Цена
}


Entity  Позиции_заказа {
  Номер заказа
  Товар
  Кол-во товаров
  Добаввить позицию()
  Убрать позицию()
}


Entity  Категории {
  Наименование категории
  Добаввить товар в категорию()
  Убрать товар из категории()
  Переместить товар из категории()
}

Entity  Комбобургер {
  Наименование категории
  Добаввить товар в категорию()
  Убрать товар из категории()
  Переместить товар из категории()
}


Entity  Список_ингредиентов_бургера {
  Ингредиент
  Кол-во ингедиента
  Позиция в бургере
  Добавить ингредиент()
  Удалить ингредиент()
  Изменить номер позицию()
}


Entity  Ингредиент {
  Наименование ингредиента
  Цена ингредиента
}


Entity  СМС_авторизации {
  Номер тел
  Статус авторазиции
  Способ авторазиции
  Время авторизации
  Изменить статус авторизации()
}


Клиент "1" --> "0..*" Заказ: Формирует
Заказ  *--  "1..*" Позиции_заказа
Позиции_заказа "1..*"  -->   "1..*" Товар:Добавить/Удалить позицию
Товар ---|> Категории
Комбобургер ---|> Товар
Комбобургер  *--  "1..*" Список_ингредиентов_бургера
Список_ингредиентов_бургера "1..*"  -->   "1..*" Ингредиент:Добавить/Удалить ингредиент
Заказ "1"  -->   "1" Детали_оплаты_заказа:Оплатить заказ
Клиент "1" --> "0..*" СМС_авторизации: Вводит код авторизации
@enduml
```

**Диаграмма состояний**

![Image alt](https://github.com/dmatwe/projects/blob/main/OTUS_SA_ADVANCED/UML/uml_s.png)

```json
@startuml
!theme plain
scale 1000 width

state Терминал {
[*] -> Временный_заказ 

Временный_заказ --> Создан: Клиент завершил формирование корзины
Создан --> Заказ_оплачен: Позиции заказа подтверждены


Временный_заказ: Добавить товар в корзину
Создан: Выбрать способ и время получения заказа
Заказ_оплачен: Оплатить заказ
Заказ_оплачен: Отменить заказ


}

state Производство {
  state Передан_в_производство
  [*] --> Передан_в_производство
  Передан_в_производство --> Приготовлен: Заказ приготовлен 

Передан_в_производство: Изменить статус заказа
Приготовлен: Изменить статус заказа
}


state Выдача {
  state Выдача_заказа
  [*] --> Выдача_заказа


Выдача_заказа: Изменить статус заказа
заказ_получен: Изменить статус заказа
Самоотказ: Изменить статус заказа

Выдача_заказа --> заказ_получен : Клиент забрал заказ
Выдача_заказа --> Самоотказ : Заказ не был получен клиентом в течение 3х часов
}

Заказ_оплачен --> Производство : оплата заказа завершена успешно

Приготовлен --> Выдача : передача заказа на доставку


Самоотказ --> [*] : Завершение сеанса

заказ_получен --> [*] : Завершение сеанса


Самоотказ --> База_данных : Добавление заказа в БД


заказ_получен --> База_данных : Добавление заказа в БД


Заказ_оплачен --> [*] : клиент не оплатил заказ в течение 2 минут, заказ удаляется


state База_данных {
  state Хранение_записи_в_бд
  [*] --> Хранение_записи_в_бд
  

Хранение_записи_в_бд: Вставить запись
Хранение_записи_в_бд: Удалить запись заказа через год

}
Хранение_записи_в_бд --> [*]
@enduml
```



**WireFrame** 

![Image alt](https://github.com/dmatwe/projects/blob/main/OTUS_SA_ADVANCED/WireFrame/WireFrame.png)

**User Story:** 

Система должна предоставлять посетителю ресторана возможность оформить заказ, которая включает в себя возможность ознакомиться с меню, добавить интересующие позиции в корзину, указать информацию “в зале” или “на вынос”, произвести оплату, после чего посетителю выдается талон с номером заказа. Также при оформлении заказа нужно учитывать, что если посетитель не зарегистрирован в нашей программе лояльности, нужно предложить ему это сделать. После готовности заказа информация об этом отображается на информационном табло, после чего посетитель предъявляет талон и забирает свой заказ. При возникновении проблем с заказом пользователь должен получить информационное сообщение с призывом обратиться к менеджеру на гостеприимстве.



 **Проектирование ресурсной модели Open API**
 
 - [Спецификация](https://app.swaggerhub.com/apis/DenisMatveev/order/1.0.0-oas3)

**Контракт метода POST /orders/{orderId}/repeat:**

 | Краткое описание        | Повторение заказа                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| ----------------------- | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| Тип запроса             | post                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| Адрес                   | /orders/{orderId}/repeat                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| Структура запроса       | Заголовки:<br>content: application/json<br>Пример:<br>POST /orders/id8282/repeat                                                                                                                                                                                                                                                                                                                                                                               |
| Структура ответа        | Структура при успехе:<br>При успешном оформлении заказа возвращается:<br>\- order_id: ID заказа (string 250)<br>\- message: сообщение о статусе заказа (string 250)<br>\- time: время оформления заказа (string 250)<br><br>Структура при ошибке:<br>\- HTTP-код ответа integer<br>\- краткое описание причины ошибки - string(250)<br>\- пример:<br><br>{<br>"code": 400,<br>"message":<br>"Неверный запрос, например, неполные или некорректные данные"<br>} |
| Список возможных ошибок | \- 400 : Неверный запрос, например, неполные или некорректные данные<br>\- 401: Пользователь не авторизован<br>\- 403: Пользователь не имеет права на оформление заказа<br>\- 404: Заказ не найден<br>\- 500: Внутренняя ошибка сервера                                                                                                                                                                                                                        |

```json
---
openapi: 3.0.0
info:
  title: Dot Eats
  description: API для заказа блюд через приложение
  version: 1.0.0-oas3
servers:
- url: https://virtserver.swaggerhub.com/cottoffeus/Dot_Eats/1
  description: SwaggerHub API Auto Mocking
paths:
  /auth/login:
    post:
      tags:
      - Технические методы
      summary: Аутентификация пользователя
      description: "Позволяет пользователю войти в систему, используя логин и пароль."
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/auth_login_body'
        required: true
      responses:
        "200":
          description: Успешная аутентификация
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/inline_response_200'
        "401":
          description: Неверные учетные данные
        "500":
          description: Внутренняя ошибка сервера
  /dishes:
    get:
      tags:
      - Просмотр блюд
      summary: Получение списка блюд
      parameters:
      - name: cusine
        in: query
        description: Фильтр по типу кухни
        required: false
        style: form
        explode: true
        schema:
          type: string
          enum:
          - russian
          - italian
          - georgian
          - asian
      - name: category
        in: query
        description: Фильтр по категории блюда
        required: false
        style: form
        explode: true
        schema:
          type: string
          enum:
          - starter
          - mainCourse
          - dessert
          - soup
          - salad
          - sideDish
          - beverage
      - name: raiting
        in: query
        description: Фильтр по рейтингу блюда
        required: false
        style: form
        explode: true
        schema:
          type: string
          enum:
          - Превосходно
          - Выше Ожидаемого
          - Удовлетворительно
          - Слабо
          - Отвратительно
          - Тролль
      - name: price_min
        in: query
        description: Минимальная цена блюда
        required: false
        style: form
        explode: true
        schema:
          type: number
      - name: price_max
        in: query
        description: Максимальная цена блюда
        required: false
        style: form
        explode: true
        schema:
          type: number
      - name: page
        in: query
        description: Номер страницы для пагинации
        required: false
        style: form
        explode: true
        schema:
          type: integer
          default: 1
      - name: pageSize
        in: query
        description: Количество блюд на странице
        required: false
        style: form
        explode: true
        schema:
          type: integer
          default: 10
      responses:
        "200":
          description: Список блюд
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/inline_response_200_1'
      security:
      - bearerAuth: []
  /dishes/{dishId}:
    get:
      tags:
      - Просмотр блюд
      summary: Получение деталей блюда
      parameters:
      - name: dishId
        in: path
        required: true
        style: simple
        explode: false
        schema:
          type: string
      responses:
        "200":
          description: Детали блюда
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/DishExtended'
      security:
      - bearerAuth: []
  /cart/items:
    get:
      tags:
      - Работа с заказом и корзиной
      summary: Получение товаров в корзине
      description: "Возвращает список товаров, находящихся в корзине пользователя."
      operationId: getCartItems
      responses:
        "200":
          description: Список товаров в корзине
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CartItemsResponse'
        "401":
          description: "Неавторизован, пользователь не аутентифицирован"
        "404":
          description: Корзина не найдена
        "500":
          description: Внутренняя ошибка сервера
    post:
      tags:
      - Работа с заказом и корзиной
      summary: Добавление блюда в корзину
      description: Добавляет указанное блюдо в корзину пользователя.
      operationId: addItemToCart
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/AddItemRequest'
        required: true
      responses:
        "201":
          description: Блюдо успешно добавлено в корзину
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AddItemResponse'
        "400":
          description: "Неверный запрос, например, отсутствует идентификатор блюда или количество"
        "401":
          description: Пользователь не авторизован
        "500":
          description: Внутренняя ошибка сервера
  /cart/items/{itemId}:
    patch:
      tags:
      - Работа с заказом и корзиной
      summary: Редактирование блюда в корзине
      description: Обновляет количество указанного блюда в корзине пользователя.
      operationId: updateCartItem
      parameters:
      - name: itemId
        in: path
        description: Уникальный идентификатор блюда
        required: true
        style: simple
        explode: false
        schema:
          type: string
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UpdateItemRequest'
        required: true
      responses:
        "200":
          description: Информация о блюде успешно обновлена
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UpdateItemResponse'
        "400":
          description: "Неверный запрос, например, отсутствует количество"
        "401":
          description: Пользователь не авторизован
        "404":
          description: Блюдо не найдено в корзине
        "500":
          description: Внутренняя ошибка сервера
  /cart/checkout:
    post:
      tags:
      - Работа с заказом и корзиной
      summary: Оформление заказа
      description: Оформляет заказ на основе текущего содержимого корзины пользователя.
      operationId: checkoutCart
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CheckoutRequest'
        required: true
      responses:
        "200":
          description: Заказ успешно оформлен
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CheckoutResponse'
        "400":
          description: "Неверный запрос, например, неполные или некорректные данные"
        "401":
          description: Пользователь не авторизован
        "403":
          description: Пользователь не имеет права на оформление заказа
        "404":
          description: Корзина не найдена
        "500":
          description: Внутренняя ошибка сервера
      security:
      - bearerAuth: []
  /orders/{orderId}/payment:
    post:
      tags:
      - Работа с заказом и корзиной
      summary: Инициация оплаты заказа
      description: Инициирует процесс оплаты для указанного заказа и возвращает ссылку для перенаправления на платежный шлюз.
      operationId: initiatePayment
      parameters:
      - name: orderId
        in: path
        description: Уникальный идентификатор заказа
        required: true
        style: simple
        explode: false
        schema:
          type: string
      responses:
        "303":
          description: Перенаправление на платежный шлюз
          headers:
            Location:
              description: URL платежного шлюза
              style: simple
              explode: false
              schema:
                type: string
              example: https://help.reg.ru/support/hosting/redirekty/kak-sdelat-redirekt-na-html
        "400":
          description: "Неверный запрос, например, неполные или некорректные данные"
        "401":
          description: Пользователь не авторизован
        "403":
          description: Пользователь не имеет права на оплату данного заказа
        "404":
          description: Заказ не найден
        "500":
          description: Внутренняя ошибка сервера
      security:
      - bearerAuth: []
  /orders/{orderID}/status:
    get:
      tags:
      - Получение статуса заказа
      parameters:
      - name: orderID
        in: path
        description: Уникальный идентификатор заказа
        required: true
        style: simple
        explode: false
        schema:
          type: string
      responses:
        "200":
          description: Статус получен
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/inline_response_200_2'
        "400":
          description: "Неверный запрос, например, неполные или некорректные данные"
        "401":
          description: Пользователь не авторизован
        "403":
          description: Пользователь не имеет права на оформление заказа
        "404":
          description: Корзина не найдена
        "500":
          description: Внутренняя ошибка сервера
  /dishes/{dishId}/reviews:
    post:
      tags:
      - Добавление отзыва о заказанном блюде
      parameters:
      - name: dishId
        in: path
        description: Уникальный идентификатор блюда
        required: true
        style: simple
        explode: false
        schema:
          type: string
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/dishId_reviews_body'
        required: true
      responses:
        "200":
          description: Отзыв успешно добавлен
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AddReviews'
        "400":
          description: "Неверный запрос, например, отсутствует идентификатор блюда или количество"
        "401":
          description: Пользователь не авторизован
        "500":
          description: Внутренняя ошибка сервера
  /orders/{orderId}/repeat:
    post:
      tags:
      - Работа с заказом и корзиной
      summary: Повторение заказа
      operationId: repeatOrder
      parameters:
      - name: orderId
        in: path
        description: Уникальный идентификатор заказа
        required: true
        style: simple
        explode: false
        schema:
          type: string
      responses:
        "200":
          description: Заказ успешно оформлен
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CheckoutResponse'
        "400":
          description: "Неверный запрос, например, неполные или некорректные данные"
        "401":
          description: Пользователь не авторизован
        "403":
          description: Пользователь не имеет права на оформление заказа
        "404":
          description: Заказ не найден
        "500":
          description: Внутренняя ошибка сервера
      security:
      - bearerAuth: []
  /orders:
    get:
      tags:
      - Работа с заказом и корзиной
      summary: Метод получения истории заказов
      description: "Метод предназначен для получения списка заказов, сохраненных в БД."
      operationId: getOrders
      responses:
        "200":
          description: Список заказов
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/CheckoutResponse'
components:
  schemas:
    AddItemRequest:
      required:
      - itemId
      - quantity
      type: object
      properties:
        itemId:
          type: string
          description: Уникальный идентификатор блюда
        quantity:
          type: integer
          description: Количество добавляемых блюд
    AddItemResponse:
      type: object
      properties:
        message:
          type: string
          description: Сообщение о результате добавления
        cartTotal:
          type: integer
          description: Общее количество блюд в корзине
    CartItemsResponse:
      type: object
      properties:
        userId:
          type: string
          description: Уникальный идентификатор пользователя
        items:
          type: array
          items:
            $ref: '#/components/schemas/CartItem'
        totalPrice:
          type: number
          description: Общая стоимость всех товаров в корзине
          format: float
    CartItem:
      type: object
      properties:
        itemId:
          type: string
          description: Уникальный идентификатор товара
        name:
          type: string
          description: Название товара
        quantity:
          type: integer
          description: Количество товара в корзине
        price:
          type: number
          description: Цена за единицу товара
          format: float
    UpdateItemRequest:
      required:
      - quantity
      type: object
      properties:
        quantity:
          type: integer
          description: Новое количество блюда
    UpdateItemResponse:
      type: object
      properties:
        message:
          type: string
          description: Сообщение о результате обновления
        updatedItem:
          $ref: '#/components/schemas/CartItem'
    CheckoutRequest:
      type: object
      properties:
        address:
          type: string
          description: Адрес доставки
        paymentMethod:
          type: string
          description: Способ оплаты
          enum:
          - card
          - ewallet
          - sbp
          - tpay
          - spay
          - cash
    CheckoutResponse:
      type: object
      properties:
        orderId:
          type: string
          description: Уникальный идентификатор заказа
        message:
          type: string
          description: Сообщение о статусе заказа
        time:
          type: string
          description: Время заказа с точностью до миллисекунд
          example: 1996-12-20T00:39:57.870Z
    Dish:
      type: object
      properties:
        id:
          type: string
        name:
          type: string
        imageLink:
          type: string
          format: url
          example: https://static.wikia.nocookie.net/harrypotter/images/c/c5/Pumpkin_Juice_WWHP.jpg/revision/latest/scale-to-width-down/1000?cb=20110529053444
    DishExtended:
      allOf:
      - $ref: '#/components/schemas/Dish'
      - type: object
        properties:
          description:
            type: string
          cusine:
            type: string
            enum:
            - russian
            - italian
            - georgian
            - asian
          category:
            type: string
            enum:
            - starter
            - mainCourse
            - dessert
            - soup
            - salad
            - sideDish
            - beverage
          raiting:
            type: string
            enum:
            - Превосходно
            - Выше Ожидаемого
            - Удовлетворительно
            - Слабо
            - Отвратительно
            - Тролль
          price:
            type: number
    AddReviews:
      required:
      - reviewId
      - status
      - textReview
      type: object
      properties:
        textReview:
          type: string
        reviewId:
          type: string
        status:
          type: string
    auth_login_body:
      required:
      - password
      - username
      type: object
      properties:
        username:
          type: string
          description: Имя пользователя
        password:
          type: string
          description: Пароль пользователя
          format: password
    inline_response_200:
      type: object
      properties:
        token:
          type: string
          description: Токен доступа
          format: JWT
          example: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMjM0NTY3ODkwIiwibmFtZSI6IkhhcnJ5IFBvdHRlciIsImlhdCI6MTUxNjIzOTAyMn0.Jkr1iBrO9-cr7uZRYhvE8BuSXIfuPnQWuZBNBE60t14
    inline_response_200_1:
      type: object
      properties:
        total:
          type: integer
          description: "Общее количество блюд, соответствующих фильтрам"
        dishes:
          type: array
          items:
            $ref: '#/components/schemas/Dish'
        page:
          type: integer
          description: Текущая страница
        pageSize:
          type: integer
          description: Количество блюд на странице
    inline_response_200_2:
      type: object
      properties:
        status:
          type: string
    dishId_reviews_body:
      type: object
      properties:
        textReview:
          type: string
  securitySchemes:
    bearerAuth:
      type: http
      scheme: bearer
      bearerFormat: JWT

```

**Модель C4: компонентная архитектура приложения**

![Image alt](https://github.com/dmatwe/projects/blob/main/OTUS_SA_ADVANCED/Модель%20C4/C4.png)
