База данных интернет-магазина одежды содержит большое количество данных о клиентах, заказах, поставках и других операциях. В связи с этим, рост базы данных может быть значительным.


**Прогноз по возможному росту базы данных:**
Прогнозируется увеличение объема данных в базе на 20% ежегодно.

Ожидается, что объем хранимых данных в базе данных будет увеличиваться со временем. Это может быть вызвано увеличением количества товаров, добавлением новых категорий и атрибутов, расширением информации о заказах и клиентах и ростом объема заказов.

Предполагается, что увеличение объема хранимых данных приведет к необходимости расширения серверной инфраструктуры для обработки запросов и обеспечения доступности базы данных.



**Рост количества пользователей:**
Ожидается увеличение числа пользователей на 30% ежегодно.
Это может быть результатом расширения бизнеса, улучшения пользовательского опыта, ростом новых клиентов, добавления новых отделов (например, отдел маркетинга, отдел логистики и т.д.) и увеличения операционной активности. 


**Всплески одновременных соединений:**
Ожидается, что всплески одновременных соединений будут происходить регулярно. Это связано с большим количеством клиентов, которые используют интернет-магазин одежды одновременно. Например, в пиковые часы или во время распродаж может быть большое количество клиентов, которые одновременно пытаются получить доступ к системе, просмотреть товары и сделать заказы. 

Для обработки таких всплесков необходимо предусмотреть возможность масштабирования системы.


**Возможные угрозы:**
- Фишинговые атаки, направленные на получение доступа к личным данным клиентов.
- Кибератаки и взлом базы данных;
- Потеря данных из-за сбоев оборудования или программного обеспечения;
- Неправомерный доступ и утечка конфиденциальной информации.




**Методы защиты:**
- Обучение сотрудников правилам безопасности и использование антивирусного ПО.
- Регулярное обновление и патчинг базы данных и серверов;
- Использование сильных паролей и механизмов аутентификации;
- Шифрование данных в покое и в движении;
- Резервное копирование данных и хранение их на отдельных серверах;
- Мониторинг и аудит базы данных для обнаружения несанкционированных действий;
-  Установление политик безопасности, которые определяют права доступа пользователей и устанавливают механизмы контроля за их использованием.



**Стратегии бэкапа:**

1) Полный бэкап (Full Backup):
- Ежемесячное выполнение полного бэкапа всей базы данных. 

2) Дифференциальный бэкап (Differential Backup):
- Дифференциальный бэкап резервирует только измененные данные с момента последнего полного бэкапа.
- Выполнять дифференциальные бэкапы ежедневно.

3) Инкрементальный бэкап (Incremental Backup):
- Создание инкрементального бэкапа, который содержит только измененные данные с момента предыдущего выполнения бэкапа (полного или инкрементального)
- Выполнять дифференциальные бэкапы 2 раза в день.

4) Транзакционный журнал (Transaction Log):
- Включить режим полного восстановления базы данных и регулярно выполнять резервное копирование транзакционного журнала.
- Резервное копирование транзакционного журнала позволяет восстановить базу данных до конкретной точки во времени.
- Выполнять езервное копирование транзакционного журнала с заданной периодичностью, например, каждые 15 минут или каждый час, в зависимости от важности данных и частоты изменений.

5) Проверка целостности бэкапов:
- Регулярно проверять целостность бэкапов, чтобы убедиться, что они могут быть успешно восстановлены.
- Проводить тестовое восстановление на отдельном сервере или виртуальной машине, чтобы убедиться, что бэкапы работают корректно.

6) Автоматизация бэкапов:
- Использовать автоматизированные задачи или планировщик задач для регулярного выполнения бэкапов.
- Настроить оповещения о статусе бэкапов, чтобы быть в курсе успешности или неудачи операции.

7) Хранение бэкапов:
- Хранить бэкапы на отдельном сервере или в облачном хранилище.
- Разграничеть доступ к бэкапам


**Стратегия репликации:**

1) Асинхронная репликация
- При асинхронной репликации изменения, сделанные на основной базе данных, передаются на вторичную базу данных с некоторой задержкой. Это позволяет основной базе данных работать независимо от реплицированных баз данных.
- Асинхронная репликация может быть полезна в случае, когда небольшая задержка в обновлении данных на вторичных базах данных не является проблемой.
- Преимущества: работа основной базы данных не замедляется из-за репликации, увеличивается отказоустойчивость системы.
- Недостатки: возможна потеря данных в случае сбоя основной базы данных, задержки на стороне подчиненного
сервера.

![Image alt](https://github.com/dmatwe/projects/blob/main/OTUS_BD/MySQL/Модель%20хранения/Асинхронная.png)

Запрос выполняется на мастере, далее binlog мастера передается по запросу через потоки в relay log на реплику.
При этом, на мастере происходит commit. На реплике relay log проигрывается, применяется и сохраняется и затем
на нем тоже происходит commit.


2) Полусинхронная репликация:
- Полусинхронная репликация объединяет преимущества асинхронной и синхронной репликации.
- При полусинхронной репликации изменения, сделанные на основной базе данных, передаются на вторичную базу данных, и обновление считается успешным только после подтверждения получения изменений вторичной базой данных.
- Это обеспечивает достаточно высокую отказоустойчивость и минимальную потерю данных в случае сбоя основной базы данных.
- Преимущества: более надежная репликация по сравнению с асинхронной, низкая задержка в обновлении данных на вторичных базах данных.
- Недостатки: возможна некоторая задержка в обновлении данных на вторичных базах данных, снижается скорость работы Мастера (необходимость ожидания подтверждения)

![Image alt](https://github.com/dmatwe/projects/blob/main/OTUS_BD/MySQL/Модель%20хранения/Полусинхронная.png)

Мастер ждет, пока хотя бы одна реплика не получит и не зарегистрирует события (ACK=acknowledged), а затем фиксирует
транзакцию. Мастер не ждет, пока все реплики подтвердят получение, и требует только подтверждения получения данных
от реплик, а не того, чтобы события были полностью выполнены и зафиксированы на стороне реплики. Таким образом,
полусинхронная репликация гарантирует, что в случае сбоя источника все зафиксированные им транзакции будут
переданы по крайней мере в одну реплику.

3. Синхронная репликация:
- При синхронной репликации изменения, сделанные на основной базе данных, передаются на вторичную базу данных немедленно и обновление считается успешным только после получения подтверждения от вторичной базы данных.
- Синхронная репликация обеспечивает максимальную надежность данных и минимальное время восстановления в случае сбоя основной базы данных.
- Преимущества: минимальная задержка в обновлении данных на вторичных базах данных, отсутствие потери данных в случае сбоя основной базы данных.
- Недостатки: синхронная репликация может замедлить работу основной базы данных, требует более высокой степени отказоустойчивости системы.

4. Групповая репликация:
- Групповая репликация включает две или более баз данных, связанных в группу, где каждая база данных реплицируется в другие базы данных в группе.
- Групповая репликация позволяет создать более сложную топологию репликации и обеспечить более высокую отказоустойчивость, резервирование и доступность данных.
- Преимущества: высокая отказоустойчивость и доступность данных, возможность репликации в различные регионы для улучшенной производительности.
- Недостатки: более сложная настройка и управление, требуется межбазовая синхронизация.

![Image alt](https://github.com/dmatwe/projects/blob/main/OTUS_BD/MySQL/Модель%20хранения/Групповая.png)

Серверы в группе координируются при помощи механизма передачи сообщений. Запрос передается серверной группе.
Затем серверная группа утверждает транзакцию, и один из серверов фиксирует операцию записи, которая затем
реплицируется в группу. Для любой операции чтения утверждение из группы серверов не требуется, и все такие запросы
на чтение выполняются немедленно. Такая конфигурация используется при работе InnoDB Cluster.


**Стратегии кластеризации:**

Общая стратегия кластеризации может включать комбинацию данных методов:

1. Горизонтальное масштабирование (шардинг):
   - Разделение базы данных на несколько физических или логических частей (шардов), где каждый шард содержит только часть данных.
   - Шарды могут быть разделены по географическому признаку, по категориям товаров или другим логическим параметрам.
   - Каждый шард может храниться на отдельном сервере, что позволяет равномерно распределить нагрузку между серверами.
   - При необходимости можно добавлять новые шарды для обработки увеличивающегося объема данных.
   - Возможно использование горизонтального масштабирования для обработки всплесков одновременных соединений путем добавления новых серверов.

2. Вертикальное масштабирование:
   - Улучшение производительности базы данных путем повышения мощности сервера или добавления дополнительных ресурсов (процессоров, памяти, дискового пространства и т.д.).
   - С помощью вертикального масштабирования можно обрабатывать более высокую нагрузку при увеличении количества пользователей.
   - Тем не менее, вертикальное масштабирование имеет свои ограничения, связанные с максимальными возможностями сервера.

3. Использование кэширования:
   - Кэширование запросов и результатов запросов может значительно улучшить производительность базы данных.
   - Можно использовать кэширование на уровне базы данных или на уровне приложения с помощью инструментов кэширования, таких как Redis или Memcached.
